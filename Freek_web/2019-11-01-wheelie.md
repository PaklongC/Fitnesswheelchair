---
layout: post
title: Main program wheelie.py in depth
subtitle: program explained
bigimg: /img/banner2.png
---
<html>
<div class="row get-started-wrap">
<img src="\Fitnesswheelchair\img\rolstoel.jpg" width="376"> <img src="\Fitnesswheelchair\img\arduinonono.jpg" width="376">
</div>
</html>
This page contains a detailed explanation of our source code. For the full source code go to our github page.  
## Explanation of wheelie.py
Wheelie.py is the main data collector of our project. with this script we collect data, send data, save data and send feedback to the user. For this explanation will will run through the code like it is ran when the piserver starts the code
#start main loop (wheelie)
```python
def start_data_collection():
    try:
        print('started connection & data collection thread')
        global thread
        thread = Thread(target=start_connection)
        thread.start()
    except:
        print('could not start thread')
```
#get session index
To keep track of all the workout sessions we save a session_index.csv that keeps track of the workouts, some basic info of the workout and where the workoutdata is stored.

In turn other clients like jupyternotebook can ask the server for this index
```python
  #HTTP request listener that returns the saved index of all the workout sessions from session_index.csv
  @app.route('/getIndex', methods = ['GET'])
  def get_session_index():
      #set our index path
      indexPath = os.path.join(os.path.dirname(os.path.abspath(__file__)),"rpi","session_index.csv")
      try:
          #read our index and put it in an list: session_index
          with open(indexPath, 'r') as f:
              reader = csv.reader(f)
              session_index = list(reader)
              f.close()
          print("HTTP send from",indexPath,":",session_index)
      except: print("could not get session index from:",indexPath)
      #Send the session_index list as an json to the client
      return json.dumps(session_index)
```
# get session data
When this function is called we return the data of a specific session.
The server reads the specific csv file and returns it in json format to the client

```python
#HTTP request listener that returns the saved workout data
@app.route('/getSessionData', methods = ['GET'])
def get_session_data():
    #convert the optional args from the url to get the specific session name
    #if none use defaultdata.csv
    sessionFileName = request.args.get('csvName', default="defaultdata.csv", type=str)

    #set the path where we get the session data from
    sessionPath = os.path.join(os.path.dirname(os.path.abspath(__file__)),"rpi","data",sessionFileName)
    #open the file and convert it to a list
    with open(sessionPath, 'r') as sf:
        reader = csv.reader(sf)
        session_Data = list(reader)
        sf.close()
    #return the session data as an json to the client
    return json.dumps(session_Data)
```
# Titel
tekst

```python

```
# Titel
tekst

```python

```
# Titel
tekst

```python

```
